# Van
## é¡¹ç›®ä»‹ç»
[Van](https://admin.l1yp.com/) æ˜¯ä¸€ä¸ªå·¥ä½œæµå’Œä½ä»£ç çš„å‰ç«¯è§£å†³æ–¹æ¡ˆï¼ŒåŸºäº [Vue3](https://staging-cn.vuejs.org/guide/introduction.html) å’Œ [Element-Plus](https://element-plus.org/zh-CN/guide/design.html) å®ç°ã€‚

[Van](https://admin.l1yp.com/) ä½¿ç”¨äº†ç›®å‰æœ€æ–°çš„æŠ€æœ¯ä½“ç³»ï¼Œå†…ç½®äº†åŠ¨æ€è·¯ç”±ï¼Œèœå•ç®¡ç†ï¼Œç”¨æˆ·ç®¡ç†ï¼Œç»„ç»‡æœºæ„ç­‰åŸºç¡€åŠŸèƒ½ï¼ŒçŠ¶æ€ç®¡ç†é‡‡ç”¨ Vue3 çš„ [Provide / Inject](https://staging-cn.vuejs.org/guide/components/provide-inject.html#provide)ï¼Œç»„ä»¶é€šä¿¡åŸºäº MITTã€‚

å®ç°äº†å„ç§éå¸¸å¥½ç”¨çš„åŸºç¡€ç»„ä»¶ï¼š[ç”¨æˆ·é€‰æ‹©å™¨](https://admin.l1yp.com/user/profile)ï¼Œéƒ¨é—¨é€‰æ‹©å™¨ï¼Œå­—å…¸è¾“å…¥/è¾“å‡ºç»„ä»¶ã€‚

[å·¥ä½œæµè®¾è®¡å™¨](https://admin.l1yp.com/process/app/design/2?processKey=holiday) åŸºäº [bpmn-js 9.0.3](https://github.com/bpmn-io/bpmn-js) å®ç°ã€‚

[åœ¨çº¿è¡¨å•](https://admin.l1yp.com/process/model/form) åŸºäº [Vuedraggable.next](https://github.com/SortableJS/vue.draggable.next) å®ç°ï¼Œæ”¯æŒæ‹–æ‹‰æ‹½ç”ŸæˆJSONå¹¶åœ¨çº¿é¢„è§ˆã€‚

ä»£ç é¢„è§ˆé‡‡ç”¨ [CodeMirror6](https://codemirror.net/) å®ç°ã€‚

- [ğŸ‘€åœ¨çº¿é¢„è§ˆ](https://admin.l1yp.com/)
- âœˆä½¿ç”¨æ•™ç¨‹ï¼šæ­£åœ¨ç­¹å¤‡
- 

# Features
- [x] æ‹–æ‹½æ§ä»¶ç”Ÿæˆè¡¨å•ï¼Œæµç¨‹é¡µé¢ç»‘å®šåœ¨çº¿è¡¨å•
- [x] æ”¯æŒçˆ¶å­è¡¨å…³è”ï¼ŒåŠ¨æ€æ–°å¢å¤šæ¡ä¸æµç¨‹å…³è”çš„å•æ®
- [x] æ”¯æŒå­æµç¨‹ï¼Œé‡‡ç”¨CallActivityå®ç°
- [x] è¡¨è¾¾å¼(æ¡ä»¶)å¯è§†åŒ–ç¼–è¾‘
- [x] æµç¨‹è§†å›¾å¯è§†åŒ–é…ç½®
- [x] æµç¨‹æ”¯æŒé™„ä»¶/å¤‡æ³¨


## èµ·æ­¥

```sh
npm install -g pnpm # å®‰è£…pnpm
pnpm install # å®‰è£…ä¾èµ–
```

### å¼€å‘

```sh
npm run dev
```

### ç¼–è¯‘

```sh
npm run build
```

# æ¼”ç¤ºåœ°å€
æ¥å£éƒ¨ç½²åœ¨æœ¬åœ°ï¼Œå¯èƒ½å¶å°”ä¼šæ‰çº¿ï¼šhttps://admin.l1yp.com/
å‘ç°æ‰çº¿å¯ä»¥åŠ ç¾¤è”ç³»æˆ‘ï¼š[770709473](https://jq.qq.com/?_wv=1027&k=hyd5LqDR)


# åŠŸèƒ½æˆªå›¾

| æ¨¡å—  | åŠŸèƒ½       | æˆªå›¾                                               |
|-----|----------|--------------------------------------------------|
| ç³»ç»Ÿ  | ç”¨æˆ·ç®¡ç†     | ![ç”¨æˆ·ç®¡ç†](docs/images/user-manage.png)             |
| ç³»ç»Ÿ  | è§’è‰²ç®¡ç†     | ![è§’è‰²ç®¡ç†](docs/images/role-manage.png)             |
| ç³»ç»Ÿ  | èœå•ç®¡ç†     | ![èœå•ç®¡ç†](docs/images/menu-manage.png)             |
| ç³»ç»Ÿ  | éƒ¨é—¨ç®¡ç†     | ![éƒ¨é—¨ç®¡ç†](docs/images/dept-manage.png)             |
| ç³»ç»Ÿ  | å­—å…¸ç®¡ç†     | ![å­—å…¸ç®¡ç†](docs/images/dict-manage.png)             |
| æµç¨‹  | æµç¨‹æ¨¡å‹     | ![æµç¨‹æ¨¡å‹](docs/images/process-model-list.png)      |
| æµç¨‹  | æµç¨‹å­—æ®µ     | ![æµç¨‹å­—æ®µ](docs/images/process-field-list.png)      |
| æµç¨‹  | æµç¨‹è¡¨å•     | ![æµç¨‹é¡µé¢(è¡¨å•)](docs/images/process-page-list.png)   |
| æµç¨‹  | è¡¨å•é…ç½®     | ![æµç¨‹è¡¨å•é…ç½®](docs/images/process-page-config.png)   |
| æµç¨‹  | æµç¨‹è§†å›¾(å®ä¾‹) | ![æµç¨‹å®ä¾‹åˆ—è¡¨](docs/images/process-instance-list.png) |
| æµç¨‹  | æµç¨‹è®¾è®¡å™¨    | ![æµç¨‹è®¾è®¡å™¨](docs/images/process-designer.png)       |
| æµç¨‹  | æµç¨‹è¯¦æƒ…     | ![æµç¨‹è¯¦æƒ…](docs/images/process-info.png)            |
| æµç¨‹  | æµç¨‹å†å²     | ![æµç¨‹å†å²](docs/images/process-history.png)         |
| æµç¨‹  | åœ¨çº¿è¡¨å•     | ![åœ¨çº¿è¡¨å•](docs/images/online-form.png)             |



# ç»„ä»¶

> æ ·ä¾‹
```vue
<user-selector-input
  style="width: 100%"
  v-model="selectedElem"
  :multiple="false"
  placeholder="å•é€‰ç”¨æˆ·ï¼Œvalueæ˜¯å¯¹è±¡ï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</user-selector-input>
<div>
  {{ JSON.stringify(selectedElem) }}
</div>


<user-selector-input
  style="width: 100%"
  v-model="selectedUserId"
  value-key="id"
  :multiple="false"
  placeholder="å•é€‰ç”¨æˆ·ï¼Œvalueæ˜¯idï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</user-selector-input>
<div>
  {{ selectedUserId }}
</div>
<user-selector-input
  style="width: 100%"
  v-model="selectedElems"
  multiple
  placeholder="å¤šé€‰ç”¨æˆ·ï¼Œvalueæ˜¯å¯¹è±¡æ•°ç»„ï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</user-selector-input>
<div>
  {{ JSON.stringify(selectedElems) }}
</div>

<user-selector-input
  style="width: 100%"
  v-model="selectedUserIds"
  value-key="id"
  multiple
  placeholder="å¤šé€‰ç”¨æˆ·ï¼Œvalueæ˜¯IDæ•°ç»„ï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</user-selector-input>
<div>
  {{ JSON.stringify(selectedUserIds) }}
</div>



<dept-selector-input
  style="width: 100%"
  v-model="selectedDeptElem"
  :multiple="false"
  placeholder="å•é€‰éƒ¨é—¨ï¼Œvalueæ˜¯å¯¹è±¡ï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</dept-selector-input>
<div>
  {{ JSON.stringify(selectedDeptElem) }}
</div>

<dept-selector-input
  style="width: 100%"
  v-model="selectedDeptId"
  value-key="id"
  :multiple="false"
  placeholder="å•é€‰éƒ¨é—¨ï¼Œvalueæ˜¯IDï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</dept-selector-input>
<div>
  {{ selectedDeptId }}
</div>

<dept-selector-input
  style="width: 100%"
  v-model="selectedDeptElems" multiple
  placeholder="å¤šé€‰éƒ¨é—¨ï¼Œvalueæ˜¯å¯¹è±¡æ•°ç»„ï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</dept-selector-input>
<div>
  {{ JSON.stringify(selectedDeptElems) }}
</div>

<dept-selector-input
  style="width: 100%"
  v-model="selectedDeptIds"
  value-key="id" multiple
  placeholder="å¤šé€‰éƒ¨é—¨ï¼Œvalueæ˜¯IDæ•°ç»„ï¼Œå¯åŒå‡»å¼¹æ¡†é€‰æ‹©"
>
</dept-selector-input>
<div>
  {{ JSON.stringify(selectedDeptIds) }}
</div>

<v-form-pro
  :form-attr="{labelWidth: '120px'}"
  :scheme="formScheme"
  v-model="formModel"
>

</v-form-pro>
<div>
  {{ JSON.stringify(formModel) }}
</div>
```

![ç»„ä»¶ä¾‹å­](docs/images/component-demo.png)


## å­—å…¸ç»„ä»¶
### DictTag å­—å…¸å€¼å±•ç¤ºç»„ä»¶
#### ç¤ºä¾‹
```vue
<dict-tag ident="publish" :val="scope.row.state" ></dict-tag>
```
#### å‚æ•°
```ts
interface DictTagProps {
  multiple: boolean // æ˜¯å¦å¤šé€‰
  scope: string // å­—å…¸èŒƒå›´
  ident: string // å­—å…¸æ ‡è¯†
  val: number | DictValue | number[] | DictValue[] // å­—å…¸å€¼
  valType: 'id' | 'value' | 'raw' // å­—å…¸å€¼ç±»å‹
}
```
#### æ ·å¼
![å­—å…¸æ ‡ç­¾](docs/images/dict-tag.png)


### DictInput å­—å…¸è¾“å…¥ç»„ä»¶
#### ç¤ºä¾‹
```vue
<dict-input ident="dict_type" v-model="type"></dict-input>
```
#### å‚æ•°
```ts
interface DictInputProps {
  multiple: boolean // æ˜¯å¦å¤šé€‰
  scope: string // å­—å…¸èŒƒå›´
  ident: string // å­—å…¸æ ‡è¯†
  checkStrictly: boolean // æ ‘å½¢å­—å…¸æ˜¯å¦çˆ¶å­çº§è”
  modelValue: number | number[] // å­—å…¸å€¼
  valType: 'id' | 'value' | 'raw' // å­—å…¸å€¼ç±»å‹
  placeholder: string // ç©ºæç¤ºæ–‡æœ¬
}
```

#### æ ·å¼
![å­—å…¸æ ‡ç­¾](docs/images/dict-input.png)

### SVGIconç»„ä»¶

#### ç¤ºä¾‹
```vue
<SVGIcon name="logo" width="30px" height="30px" color="red" bg-color="#FFFFFFFF"></SVGIcon>
```

#### å‚æ•°
```ts
interface SVGIconProps {
  name: string // svgæ–‡ä»¶å
}
```

### DeptSelectorInputéƒ¨é—¨é€‰æ‹©å™¨ç»„ä»¶
#### ç¤ºä¾‹
```vue
  <dept-selector-input v-model="selectedDeptElems" multiple></dept-selector-input>
```

#### å‚æ•°
```ts
interface DeptSelectorInputProps {
  multiple?: boolean // æ˜¯å¦å¤šé€‰
  modelValue: number | number[] | string | string[] | DeptView | DeptView[] | null
  valueKey?: string
  readViewFn?: (param: number | number[] | string | string[]) => DeptView
}
```
#### æ¼”ç¤ºæˆªå›¾
![ä¸‹æ‹‰æœç´¢éƒ¨é—¨](docs/images/dept-selector-dialog-search.png.png)

![å¼¹æ¡†é€‰æ‹©éƒ¨é—¨](docs/images/dept-selector-dropdown-search.png)

### UserSelectorInputç”¨æˆ·é€‰æ‹©å™¨ç»„ä»¶
#### ç¤ºä¾‹
```vue
  <user-selector-input style="width: 100%" v-model="selectedElems" multiple></user-selector-input>
```

#### å‚æ•°
```ts
interface UserSelectorInputProps {
  multiple?: boolean
  modelValue: number | number[] | string | string[] | UserView | UserView[] | null
  valueKey?: string
  readViewFn?: (param: number | number[] | string | string[]) => UserView
}
```


#### æ¼”ç¤ºæˆªå›¾
![ä¸‹æ‹‰æœç´¢ç”¨æˆ·](docs/images/user-selector-dialog-search.png.png)

![å¼¹æ¡†é€‰æ‹©ç”¨æˆ·](docs/images/user-selector-dropdown-search.png)

### VDialog å¼¹æ¡†ç»„ä»¶

#### ç¤ºä¾‹
```vue
<v-dialog
    v-model="visible"
    :title="props.title"
    @confirm="confirmDeptDialog"
    @cancel="emits('cancel')"
></v-dialog>
```

#### å‚æ•°
```ts
interface VDialogProps {
  modelValue: boolean
  title: string
  width: string | number // é»˜è®¤50%
  top: string | number // é»˜è®¤15vh
  modal: boolean // true
  appendToBody: boolean // false
  lockScroll: boolean // true
  customClass: string // true
  openDelay: number
  closeDelay: number
  closeOnClickModal: boolean
  closeOnPressEscape: boolean
  beforeClose: Function
  draggable: boolean
  center: boolean
  destroyOnClose: boolean
  fullScreen: boolean
  showFullScreen: boolean
}
```

#### äº‹ä»¶
> å†…ç½®confirm/canceläº‹ä»¶

### VFormPro è¡¨å•é…ç½®åŒ–ç»„ä»¶

#### ç¤ºä¾‹
```vue
  <v-form-pro
    :form-attr="{labelWidth: '120px'}"
    :scheme="formScheme"
    v-model="formModel"
  >
  </v-form-pro>
```

#### å‚æ•°å®šä¹‰
```ts
// å‚æ•°å®šä¹‰
interface VFormProps {
    formAttr: ElFormProps,
    scheme: FormScheme[][],
    modelValue: Record<string, any>
}

interface ElFormProps extends Record<string, any> {

}

interface FormScheme {
    name: string // map to modelValue
    label: string // æ ‡ç­¾å
    component: string // ç»„ä»¶å
    span: number // å®½åº¦
    writeable: boolean // æ˜¯å¦å¯å†™(è‹¥ä¸ºtrueåˆ™valueä¼šå‡ºç°åœ¨modelValueä¸­)
    formItemAttrs?: Record<string, any> // formItemçš„è‡ªå®šä¹‰å±æ€§
    componentAttrs?: Record<string, any> // ç»„ä»¶çš„è‡ªå®šä¹‰å±æ€§
}
```

# æµç¨‹å¼•æ“

## æ¨¡å‹
> æ¯ä¸ªæµç¨‹æ¨¡å‹æ‹¥æœ‰å¤šä¸ªbpmnç‰ˆæœ¬ï¼Œæ¯ä¸ªæµç¨‹æ¨¡å‹åªå…è®¸å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬ï¼Œé»˜è®¤ä½¿ç”¨å·²å‘å¸ƒçš„bpmnç‰ˆæœ¬å‘èµ·æµç¨‹ã€‚

![æµç¨‹æ¨¡å‹](docs/images/process_model_bpmn.png)

## å­—æ®µ
> æµç¨‹æ¨¡å‹éœ€è¦å®šä¹‰å­—æ®µç±»å‹(ç”¨äºé…ç½® **é¡µé¢**/**å®¡æ ¸äºº**)

![æµç¨‹æ¨¡å‹å­—æ®µ](docs/images/process_model_field.png)

## é¡µé¢
> é€šè¿‡å­—æ®µé…ç½®æµç¨‹é¡µé¢

![æµç¨‹æ¨¡å‹é¡µé¢](docs/images/process-model-page-designer.jpg)

## æµç¨‹è®¾è®¡å™¨
> æ”¯æŒçš„èŠ‚ç‚¹åˆ—è¡¨ï¼šç”¨æˆ·ä»»åŠ¡/å¼€å§‹/ç»“æŸ/ç½‘å…³

### çº¦å®š
å¦‚ä¸‹å›¾ï¼Œæµç¨‹èµ°åˆ°å½“å‰èŠ‚ç‚¹ï¼Œ**å®¡æ ¸è€…**å¯é€‰æ‹©**æäº¤**æˆ–**é©³å›**ï¼Œå†…éƒ¨é‡‡ç”¨ç¬æ—¶å˜é‡æ§åˆ¶æ¡ä»¶æµè½¬ã€‚
 ![è®¾è®¡å™¨](docs/images/process-designer.png)